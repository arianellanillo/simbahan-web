using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using SimbahanApp.Models;
using SimbahanApp.Transformers;

namespace SimbahanApp.Services
{
    public class FavoritesService
    {
        public List<Tuple<ChurchInfo, User>> GetChurchFollowers(int churchId)
        {
            var churchTransformer = new ChurchTransformer();
            var userTransformer = new UserTransformer();
            var followers = new List<Tuple<ChurchInfo, User>>();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetChurchFollowers", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@churchID", churchId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                        {
                            var church = churchTransformer.Transform(reader);
                            var user = userTransformer.Transform(reader);
                            var follower = new Tuple<ChurchInfo, User>(church, user);

                            followers.Add(follower);
                        }
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return followers;
        }

        public List<Organization> GetFavoriteOrganizations(int userId)
        {
            var organizationTransformer = new OrganizationTransformer();
            var organizations = new List<Organization>();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteOrganization", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                        {
                            var organization = organizationTransformer.Transform(reader);


                            //char[] separator = { ',' };
                            //var photos = reader["ChurchPhotos"].ToString().Split(separator, StringSplitOptions.None);
                            //church.ChurchPhotos = new List<ChurchPhotosModel>();
                            //foreach (var strPix in photos)
                            //    church.ChurchPhotos.Add(new ChurchPhotosModel
                            //    {
                            //        ChurchPhotos = strPix == string.Empty ? "" : @"Images\Photos\" + strPix
                            //    });

                            organizations.Add(organization);
                        }
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return organizations;
        }

        public List<ChurchInfo> GetFavoriteChurches(int userId)
        {
            var churchTransformer = new ChurchTransformer();
            var churches = new List<ChurchInfo>();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteChurch", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                        {
                            var church = churchTransformer.Transform(reader);


                            char[] separator = {','};
                            var photos = reader["ChurchPhotos"].ToString().Split(separator, StringSplitOptions.None);
                            church.ChurchPhotos = new List<ChurchPhotosModel>();
                            foreach (var strPix in photos)
                                church.ChurchPhotos.Add(new ChurchPhotosModel
                                {
                                    ChurchPhotos = strPix == string.Empty ? "" : @"Images\Photos\" + strPix
                                });

                            churches.Add(church);
                        }
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return churches;
        }

        public List<BibleVerse> GetFavoriteBibleVerses(int userId)
        {
            var verses = new List<BibleVerse>();
            var bibleVerseTransformer = new BibleVerseTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteBibleVerse", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            verses.Add(bibleVerseTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return verses;
        }

        public List<ReligiousQuote> GetFavoriteReligiousQuotes(int userId)
        {
            var religiousQuotes = new List<ReligiousQuote>();
            var religiousQuoteTransformer = new ReligiousQuoteTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteReligiousQuote", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            religiousQuotes.Add(religiousQuoteTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return religiousQuotes;
        }

        public List<Models.MusicalInspiration> GetFavoriteInspirationalMusic(int userId)
        {
            var musicalInspirations = new List<Models.MusicalInspiration>();
            var inspirationalMusicTransformer = new InspirationalMusicTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteInspirationalMusic", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            musicalInspirations.Add(inspirationalMusicTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return musicalInspirations;
        }

        public bool AddChurch(int userId, int simbahanId)
        {
            if (IsChurchAlreadyInFavorites(userId, simbahanId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertSimbahanFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@simbahanID", simbahanId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddOrganization(int userId, int organizationId)
        {
            if (IsOrganizationAlreadyInFavorites(userId, organizationId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertOrganizationFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@organizationID", organizationId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddBibleVerse(int userId, int bibleVerseId)
        {
            if (IsBibleVerseAlreadyInFavorites(userId, bibleVerseId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertBibleVerseFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@bibleVerseID", bibleVerseId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddReligiousQuote(int userId, int religiousQuoteId)
        {
            if (IsReligiousQuoteAlreadyInFavorites(userId, religiousQuoteId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteReligiousQuote", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@religiousQuoteID", religiousQuoteId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddInspirationalMusic(int userId, int inspirationalMusicId)
        {
            if (IsInspirationalMusicAlreadyInFavorites(userId, inspirationalMusicId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteInspirationalMusic", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@inspirationalMusicID", inspirationalMusicId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool IsBibleVerseAlreadyInFavorites(int userId, int bibleVerseId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsBibleVerseInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@bibleVerseID", bibleVerseId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsReligiousQuoteAlreadyInFavorites(int userId, int religiousQuoteId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsReligiousQuoteInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@religiousQuoteID", religiousQuoteId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsInspirationalMusicAlreadyInFavorites(int userId, int inspirationalMusicId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsInspirationalMusicInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@inspirationalMusicID", inspirationalMusicId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

            public bool IsAnnouncementAlreadyInFavorites(int userID, int announcementID)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsAnnouncementsInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@AnnouncementID", announcementID);
                        cmd.Parameters.AddWithValue("@userID", userID);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) != 0;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

            public bool IsOrgAnnouncementAlreadyInFavorites(int userID, int organnouncementID)
            {
                using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
                {
                    if (dbconn.State == ConnectionState.Open)
                        dbconn.Close();
                    dbconn.Open();

                    using (var cmd = new SqlCommand("spIsOrgAnnouncementInFavorite", dbconn))
                    {
                        try
                        {
                            cmd.CommandType = CommandType.StoredProcedure;
                            cmd.Parameters.AddWithValue("@OrgAnnouncementID", organnouncementID);
                            cmd.Parameters.AddWithValue("@userID", userID);


                            var reader = cmd.ExecuteReader();

                            while (reader.Read())
                                return Convert.ToInt32(reader["result"]) != 0;
                        }
                        catch (Exception)
                        {
                            // ignored
                        }
                    }
                }

                return true;
            }

            public bool RemoveOrgAnnouncement(int userID, int organnouncementID)
            {
                if (!IsOrgAnnouncementAlreadyInFavorites(userID, organnouncementID)) return false;

                using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                    .ConnectionString))
                {
                    if (dbconn.State == ConnectionState.Open)
                        dbconn.Close();
                    dbconn.Open();

                    using (var cmd = new SqlCommand("spRemoveOrgAnnouncementFavorite", dbconn))
                    {
                        try
                        {
                            cmd.CommandType = CommandType.StoredProcedure;
                            cmd.Parameters.AddWithValue("@OrgAnnouncementID", organnouncementID);
                            cmd.Parameters.AddWithValue("@userID", userID);


                            cmd.ExecuteNonQuery();

                            return true;
                        }
                        catch (Exception)
                        {
                            // ignored
                        }
                    }
                }

                return false;
            }

            public bool RemoveAnnouncement(int userID, int announcementID)
            {
                if (!IsAnnouncementAlreadyInFavorites(userID, announcementID)) return false;

                using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                    .ConnectionString))
                {
                    if (dbconn.State == ConnectionState.Open)
                        dbconn.Close();
                    dbconn.Open();

                    using (var cmd = new SqlCommand("spRemoveAnnouncementsFavorite", dbconn))
                    {
                        try
                        {
                            cmd.CommandType = CommandType.StoredProcedure;
                            cmd.Parameters.AddWithValue("@AnnouncementID", announcementID);
                            cmd.Parameters.AddWithValue("@userID", userID);


                            cmd.ExecuteNonQuery();

                            return true;
                        }
                        catch (Exception)
                        {
                            // ignored
                        }
                    }
                }

                return false;
            }

        public bool RemoveBibleVerse(int userId, int bibleVerseId)
        {
            if (!IsBibleVerseAlreadyInFavorites(userId, bibleVerseId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveBibleVerseFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@bibleVerseID", bibleVerseId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveReligiousQuote(int userId, int religiousQuoteId)
        {
            if (!IsReligiousQuoteAlreadyInFavorites(userId, religiousQuoteId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveReligiousQuoteFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@religiousQuoteID", religiousQuoteId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveInspirationalMusic(int userId, int inspirationalMusicId)
        {
            if (!IsInspirationalMusicAlreadyInFavorites(userId, inspirationalMusicId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveInspirationalMusicFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@inspirationalMusicID", inspirationalMusicId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveChurch(int userId, int simbahanId)
        {
            if (!IsChurchAlreadyInFavorites(userId, simbahanId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveChurchFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@simbahanID", simbahanId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveOrganization(int userId, int organizationId)
        {
            if (!IsOrganizationAlreadyInFavorites(userId, organizationId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveOrganizationFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@organizationID", organizationId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool IsChurchAlreadyInFavorites(int userId, int simbahanId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsChurchInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@simbahanID", simbahanId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsOrganizationAlreadyInFavorites(int userId, int organizationId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsOrganizationInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@organizationID", organizationId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public List<Models.BasicCatholicPrayer> GetFavoriteBasicCatholicPrayer(int userId)
        {
            var basicCatholicPrayer = new List<Models.BasicCatholicPrayer>();
            var basicCatholicPrayerTransformer = new BasicCatholicPrayerTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteBasicCatholicPrayer", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            basicCatholicPrayer.Add(basicCatholicPrayerTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return basicCatholicPrayer;
        }

        public List<Models.OtherCatholicPrayer> GetFavoriteOtherCatholicPrayer(int userId)
        {
            var otherCatholicPrayers = new List<Models.OtherCatholicPrayer>();
            var otherCatholicPrayerTransformer = new OtherCatholicPrayerTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteOtherCatholicPrayer", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            otherCatholicPrayers.Add(otherCatholicPrayerTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return otherCatholicPrayers;
        }

        public List<Models.Devotion> GetFavoriteDevotion(int userId)
        {
            var devotion = new List<Models.Devotion>();
            var devotionTransformer = new DevotionTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteDevotion", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            devotion.Add(devotionTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return devotion;
        }

        public List<Models.Saint> GetFavoriteSaint(int userId)
        {
            var saints = new List<Models.Saint>();
            var saintTransformer = new SaintTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteSaint", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            saints.Add(saintTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return saints;
        }

        public List<Models.Announcement> GetFavoriteAnnouncements(int userID)
        {
            var announcement = new List<Models.Announcement>();
            var announcementTransformer = new AnnouncementTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteAnnouncements", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userID);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            announcement.Add(announcementTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return announcement;
        }

        public List<Models.OrganizationAnnouncement> GetFavoriteOrgAnnouncement(int userID)
        {
            var announcement = new List<Models.OrganizationAnnouncement>();
            var announcementTransformer = new OrganizationAnnouncementTransformer();

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spGetFavoriteOrgAnnouncement", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@userID", userID);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            announcement.Add(announcementTransformer.Transform(reader));
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return announcement;
        }

        public bool AddBasicCatholicPrayer(int userId, int basicCatholicPrayerId)
        {
            if (IsBasicCatholicPrayerAlreadyInFavorites(userId, basicCatholicPrayerId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteBasicCatholicPrayer", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@basiccatholicprayerID", basicCatholicPrayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddDevotion(int userId, int devotionId)
        {
            if (IsDevotionAlreadyInFavorites(userId, devotionId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteDevotion", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@devotionID", devotionId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddSaint(int userId, int saintId)
        {
            if (IsSaintAlreadyInFavorites(userId, saintId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteSaint", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@saintID", saintId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddOtherCatholicPrayer(int userId, int othercatholicprayerId)
        {
            if (IsOtherCatholicPrayerAlreadyInFavorites(userId, othercatholicprayerId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteOtherCatholicPrayer", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@othercatholicprayerID", othercatholicprayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddAnnouncement(int userID, int announcementID)
        {
            if (IsAnnouncementAlreadyInFavorites(userID, announcementID)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteAnnouncements", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@announcementID", announcementID);
                        cmd.Parameters.AddWithValue("@userID", userID);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool AddOrgAnnouncement(int userID, int organnouncementID)
        {
            if (IsOrgAnnouncementAlreadyInFavorites(userID, organnouncementID)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spInsertFavoriteOrgAnnouncement", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@OrgannouncementID", organnouncementID);
                        cmd.Parameters.AddWithValue("@userID", userID);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool IsBasicCatholicPrayerAlreadyInFavorites(int userId, int basicCatholicPrayerId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsBasicCatholicPrayerInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@basiccatholicprayerID", basicCatholicPrayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsDevotionAlreadyInFavorites(int userId, int devotionId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsDevotionInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@devotionID", devotionId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsSaintAlreadyInFavorites(int userId, int saintId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsSaintInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@saintID", saintId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool IsOtherCatholicPrayerAlreadyInFavorites(int userId, int othecatholicprayerId)
        {
            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"].ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spIsOtherCatholicPrayerInFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@othercatholicprayerID", othecatholicprayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        var reader = cmd.ExecuteReader();

                        while (reader.Read())
                            return Convert.ToInt32(reader["result"]) == 1;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return true;
        }

        public bool RemoveBasicCatholicPrayer(int userId, int basicCatholicPrayerId)
        {
            if (!IsBasicCatholicPrayerAlreadyInFavorites(userId, basicCatholicPrayerId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveBasicCatholicPrayerFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@basiccatholicprayerID", basicCatholicPrayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveDevotion(int userId, int devotionId)
        {
            if (!IsDevotionAlreadyInFavorites(userId, devotionId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveDevotionFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@devotionID", devotionId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveSaint(int userId, int saintId)
        {
            if (!IsSaintAlreadyInFavorites(userId, saintId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveSaintFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@saintID", saintId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }

        public bool RemoveOtherCatholicPrayer(int userId, int othercatholicprayerId)
        {
            if (!IsDevotionAlreadyInFavorites(userId, othercatholicprayerId)) return false;

            using (var dbconn = new SqlConnection(ConfigurationManager.ConnectionStrings["dbconn"]
                .ConnectionString))
            {
                if (dbconn.State == ConnectionState.Open)
                    dbconn.Close();
                dbconn.Open();

                using (var cmd = new SqlCommand("spRemoveOtherCatholicPrayerFavorite", dbconn))
                {
                    try
                    {
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.Parameters.AddWithValue("@othercatholicprayerID", othercatholicprayerId);
                        cmd.Parameters.AddWithValue("@userID", userId);


                        cmd.ExecuteNonQuery();

                        return true;
                    }
                    catch (Exception)
                    {
                        // ignored
                    }
                }
            }

            return false;
        }
    }
}